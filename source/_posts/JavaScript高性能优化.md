---
title: JavaScript高性能优化
date: 2017-12-28 08:42:56
tags: javascript
---

本文章列出了《高性能javascript》一书中的一些常用性能优化，并分为几大类归类总结一下。（持续更新....）


## 加载和执行

javascript代码执行过程会阻塞浏览器的其他进程，比如界面的绘制，每次遇到`<script>`标签，页面都必须停下来等待代码下载并执行,然后才继续处理其他部分，尽管如此，还是有几种办法能够减少对javascript对性能的影响。

> 1.`<body/>`标签闭合之前，将所有的`<script>`标签放到页面的底部，能够确保脚本执行前页面已经渲染

> 2.合并脚本，页面中`<script>`标签越少，加载速度也就越快。

> 3.有多种无阻塞下载javascript的方法
> - 使用`<script>`的defer属性
> - 使用动态的`<script>`元素来下载并执行代码
> - 使用XHR对象下来javascript代码并注入到页面


## 数据存储

在javascript中，数据存储的位置会对代码性能整体产生重大影响，数据存储分为4中方式，字面量、变量、数组项、对象成员。

> 1.访问字面量和局部变量的速度最快

> 2.由于局部变量存储在作用域链的起始位置（属性搜索机制），所有访问局部变量比访问跨域变量的速度更快，由于全局变量总处于作用域链的最末端，所以访问速度是最慢的。

> 3.循环嵌套对象成员会明显的影响性能（可能会导致引用计数无法回收干净），净量少用

> 4.属性或者方法在原型链中的位置越深，访问的速度也就越慢

> 5.通常，可以把常用的对象成员，数组元素，跨域变量保存在局部变量中来改善javascript的性能。


## DOM编程

访问DOM是Web应用的重要部分，但是每次穿越ECMAScript和DOM之间，都需要一定的性能，为了减少DOM编程带来的性能损失，总结为以下几点：

> 1.最小化DOM访问次数，尽可能在javascript端处理

> 2.如果需要多次访问dom节点，请使用局部变量存储它的引用

> 3.小心处理HTML集合，因为他实时连接着底层文档，把集合长度缓存到一个变量中，并在迭代中使用他。

> 4.如果有可能的话，尽可能使用更快速的API

> 5.尽量减少重绘和重排的次数，批量修改样式时，“离线” 操作DOM树，使用缓存，并减少布局重排次数。

> 6.动画中使用绝对定位，使用拖放代理

> 7.使用事件委托来减少事件处理程序。

## 算法和流程控制

javascript和与他编程语言一样，代码的写法和算法会影响运行时间，与其他语言不同的是，javascript的运行资源有限。

> 1.for、where、do-while循环性能相当

> 2.避免使用for-in循环，除非是你需要遍历一个属性数量未知的对象

> 3.减少循环性能的最佳方式是减少迭代的运算量和减少循环迭代的次数

> 4.通常来说switch总是比if-else快

> 5.浏览器调用栈大小限制了递归算法，调用栈错误会导致其他程序终止运行（净量少用） IE调用栈与系统内存空闲有关，现代浏览器则跟调用栈大小有关。